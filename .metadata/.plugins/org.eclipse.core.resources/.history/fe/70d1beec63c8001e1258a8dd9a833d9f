import java.io.FileInputStream;
import java.io.IOException;
import java.util.Iterator;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class DatadrivenTest {

	public static void main(String[] args) throws IOException {
		FileInputStream fis=new FileInputStream("C:\\Users\\vredd\\OneDrive\\Desktop\\DatadrivenTestSample.xlsx");
		XSSFWorkbook workbook=new XSSFWorkbook(fis);
		int sheetsCount = workbook.getNumberOfSheets();
		for(int i=0;i<sheetsCount;i++)
		{
			if(workbook.getSheetName(i).equalsIgnoreCase("testdata"))
			{
			XSSFSheet sheet = workbook.getSheetAt(i);
			//Now our first requirement is to identify the Testcases column first by scanning entire row at the top as headers row we can say.
			Iterator<Row> Rows = sheet.iterator();
			//we reached to first row below
			Row firstRow = Rows.next();
			//we need to access cell by cell in a first row.
			Iterator<Cell> cell = firstRow.cellIterator();
			int k=0;
			int column;
			while(cell.hasNext())
			{
				Cell cellValue = cell.next();
				if(cellValue.getStringCellValue().equalsIgnoreCase("Testcases"))
				{
					column=k;
					
				}
				k++;
			}
			}
		}
	}

}
